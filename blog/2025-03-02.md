---
slug: event-loop-phases
title: Understanding the Event Loop Phases
authors: [erfuuan]
tags: [javascript, eventloop, nodejs]
---

The **Event Loop** is the heart of asynchronous programming in Node.js. It allows Node.js to handle non-blocking I/O operations efficiently. Understanding its **phases** is crucial for writing performant applications.

<!-- truncate -->

## **ðŸŒ Overview of the Event Loop**
Node.js is single-threaded but uses the **libuv** library to manage an asynchronous event-driven architecture. The event loop is responsible for scheduling and executing operations in different **phases**.

### **ðŸ“Œ Event Loop Phases**
The event loop has **six phases**, which execute in the following order:

1. **Timers Phase** â³
2. **I/O Callbacks Phase** ðŸŽ¯
3. **Idle, Prepare Phase** ðŸ’¤
4. **Poll Phase** ðŸ”„
5. **Check Phase** âœ…
6. **Close Callbacks Phase** ðŸ”š

Let's dive deeper into each phase.

---

### **1ï¸âƒ£ Timers Phase (setTimeout & setInterval)**
- Executes **callbacks** scheduled by `setTimeout()` and `setInterval()`.
- If a timer is due, its callback executes.
- Example:
  
  ```js
  setTimeout(() => console.log('Timer callback'), 0);
  console.log('Synchronous Code');
  ```
  **Output:**
  ```
  Synchronous Code
  Timer callback
  ```

---

### **2ï¸âƒ£ I/O Callbacks Phase**
- Executes deferred I/O callbacks, like network requests or file system operations.
- Not for timers, `setImmediate`, or polling.

---

### **3ï¸âƒ£ Idle, Prepare Phase**
- Used internally by **libuv**.
- Rarely affects user applications.

---

### **4ï¸âƒ£ Poll Phase (Core of Event Loop)**
- Retrieves new I/O events and executes **callbacks**.
- If no timers are pending, the event loop **waits for I/O** before proceeding.
- If no I/O is pending, it moves to the **Check Phase**.

---

### **5ï¸âƒ£ Check Phase (setImmediate Execution)**
- Executes `setImmediate()` callbacks.
- `setImmediate()` callbacks **always run after the poll phase**, before timers.
- Example:
  
  ```js
  setImmediate(() => console.log('setImmediate Callback'));
  setTimeout(() => console.log('setTimeout Callback'), 0);
  ```
  **Output (almost always):**
  ```
  setImmediate Callback
  setTimeout Callback
  ```

---

### **6ï¸âƒ£ Close Callbacks Phase**
- Executes close event handlers, such as `socket.on('close', callback)`.

---

## **ðŸ†š setImmediate() vs setTimeout(0)**
| Feature          | `setImmediate()` | `setTimeout(0)` |
|-----------------|----------------|----------------|
| Execution Order | Runs in **Check Phase** | Runs in **Timers Phase** |
| Priority       | Higher in some cases | Lower due to timer scheduling |

Example:
```js
setTimeout(() => console.log('setTimeout(0)'), 0);
setImmediate(() => console.log('setImmediate'));
```
**Output (usually):**
```
setImmediate
setTimeout(0)
```

---

## **ðŸŽ¯ Conclusion**
- The event loop cycles through these phases **continuously**.
- `setImmediate()` executes before `setTimeout(0)`, but it depends on the execution context.
- Understanding the **event loop phases** helps optimize performance and debugging.

Happy coding! ðŸš€
